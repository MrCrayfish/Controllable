package com.mrcrayfish.controllable.client.gui.toasts;

import com.mojang.blaze3d.systems.RenderSystem;
import com.mrcrayfish.controllable.client.gui.screens.ControllerLayoutScreen;
import net.minecraft.ChatFormatting;
import net.minecraft.client.gui.GuiGraphics;
import net.minecraft.client.gui.components.toasts.RecipeToast;
import net.minecraft.client.gui.components.toasts.Toast;
import net.minecraft.client.gui.components.toasts.ToastComponent;
import net.minecraft.network.chat.Component;
import net.minecraft.resources.ResourceLocation;

/**
 * Author: MrCrayfish
 */
public class ConnectionToast implements Toast
{
    private static final ResourceLocation BACKGROUND_SPRITE = new ResourceLocation("toast/recipe");

    private final boolean connected;
    private final Component controllerName;

    public ConnectionToast(boolean connected, String controllerName)
    {
        this.connected = connected;
        this.controllerName = Component.literal(controllerName);
    }

    @Override
    public Visibility render(GuiGraphics graphics, ToastComponent toastComponent, long delta)
    {
        RenderSystem.setShaderColor(1.0F, 1.0F, 1.0F, 1.0F);
        graphics.blitSprite(BACKGROUND_SPRITE, 0, 0, this.width(), this.height());

        RenderSystem.setShaderColor(1.0F, 1.0F, 1.0F, 1.0F);
        graphics.blit(ControllerLayoutScreen.TEXTURE, 8, 8, 20, 43, 20, 16);

        String title = toastComponent.getMinecraft().font.plainSubstrByWidth(this.controllerName.getString(), 120);
        graphics.drawString(toastComponent.getMinecraft().font, title, 35, 7, 0);

        Component message = this.connected ?
                Component.translatable("controllable.toast.connected").withStyle(ChatFormatting.DARK_GREEN).withStyle(ChatFormatting.BOLD) :
                Component.translatable("controllable.toast.disconnected").withStyle(ChatFormatting.RED).withStyle(ChatFormatting.BOLD);
        graphics.drawString(toastComponent.getMinecraft().font, message, 35, 18, 0);

        return delta >= 3000L ? Visibility.HIDE : Visibility.SHOW;
    }
}
